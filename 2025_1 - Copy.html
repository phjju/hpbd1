<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Happy Birth Day To Hien</title>
    <style>
        body {
            background: linear-gradient(135deg, #ffecd2, #fcb69f);
            font-family: Arial, sans-serif;
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            position: relative;
            z-index: 10;
        }

        .wish-image img {
            width: 200px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .dialogue {
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }

        .buddha {
            width: 120px;
            flex-shrink: 0;
            display: block;
        }

        .speech-bubble {
            background: #fff;
            border: 2px solid red;
            border-radius: 10px;
            padding: 15px 20px;
            width: 400px;
            min-height: 80px;
            font-size: 18px;
            font-weight: bold;
            color: red;
            line-height: 1.5;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            word-wrap: break-word;
            position: relative;
        }

            .speech-bubble::before {
                content: "";
                position: absolute;
                left: -15px;
                top: 30px;
                border-width: 10px 15px 10px 0;
                border-style: solid;
                border-color: transparent red transparent transparent;
            }

        .choices {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

            .choices button {
                padding: 12px 28px;
                font-size: 16px;
                font-weight: bold;
                border: none;
                border-radius: 30px;
                background: linear-gradient(135deg, #ff7eb3, #ff758c, #ff6a88);
                color: white;
                cursor: pointer;
                transition: all 0.3s ease;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            }

                .choices button:hover {
                    background: linear-gradient(135deg, #ff9a9e, #fecfef);
                    color: #333;
                    transform: translateY(-4px) scale(1.05);
                    box-shadow: 0 6px 16px rgba(0,0,0,0.3);
                }

                .choices button:active {
                    transform: translateY(0) scale(0.98);
                    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
                }

        /* Hiệu ứng nhảy cho quà */
        .gift {
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }
        }

        /* Canvas pháo hoa dưới tất cả */
        #fireworks {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1; /* dưới rewardDiv */
        }

        /* RewardDiv trong suốt */
        .rewardDiv {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: transparent; /* trong suốt để nhìn thấy pháo hoa */
            position: relative;
            z-index: 10; /* trên canvas */
        }

            /* Speech bubble riêng có nền */
            .rewardDiv .speech-bubble {
                background: white;
                border: 3px solid #ff4d6d;
                border-radius: 12px;
                padding: 18px 24px;
                width: 380px;
                min-height: 100px;
                font-size: 18px;
                font-weight: bold;
                color: #ff4d6d;
                line-height: 1.5;
                box-shadow: 0 6px 14px rgba(0,0,0,0.15);
                display: flex;
                align-items: center;
                position: relative;
            }
    </style>
</head>
<body>
    <div class="container" id="mainContainer">
        <div class="wish-image">
            <img src="main.png" alt="Hình minh họa">
        </div>

        <div class="dialogue">
            <img src="but11.png" alt="Bụt" class="buddha">
            <div class="speech-bubble" id="speech"></div>
        </div>

        <div id="choices" class="choices" style="display: none;">
            <button onclick="choose('beauty')">Xinh đẹp</button>
            <button onclick="choose('rich')">Giàu có</button>
            <button onclick="choose('hony')">Người Yêu</button>
            <button onclick="choose('other')">Khác</button>
        </div>
    </div>

    <canvas id="fireworks"></canvas>

    <script>
        const speech = document.getElementById("speech");
        const choices = document.getElementById("choices");
        const container = document.getElementById("mainContainer");

        function speakText(text) {
            if ('speechSynthesis' in window) {
                const utter = new SpeechSynthesisUtterance(text);
                utter.lang = "vi-VN";
                utter.rate = 0.95;
                utter.pitch = 1;
                speechSynthesis.speak(utter);
            }
        }

        function typeWriter(text, i = 0, callback) {
            if (i < text.length) {
                speech.innerHTML = text.substring(0, i + 1);
                let delay = 40;
                if (text.charAt(i) === ",") delay = 200;
                if (text.charAt(i) === "." || text.charAt(i) === "!" || text.charAt(i) === "?") delay = 400;
                setTimeout(() => typeWriter(text, i + 1, callback), delay);
            } else if (callback) callback();
        }

        function startIntro() {
            typeWriter("Ha Ha Ha Ha Ha, Hãy chọn quà mà con thích.");
            speakText("Ha Ha Ha Ha Ha, Hãy chọn quà mà con thích.");
            setTimeout(() => { choices.style.display = "flex"; }, 1000);
        }

        function choose(option) {
            if (option === "other") {
                container.style.display = "none";

                const rewardDiv = document.createElement("div");
                rewardDiv.className = "rewardDiv";
                rewardDiv.innerHTML = `
                        <div class="gift">
                            <img src="img/Qua.png" alt="Phần thưởng" style="width:250px; border-radius:15px; box-shadow:0 6px 20px rgba(0,0,0,0.25);">
                        </div>
                        <div class="dialogue" style="display:flex; align-items:flex-start; gap:15px; margin-top:20px;">
                            <img src="but22.png" alt="Bụt" class="buddha" style="width:120px; display:block;">
                            <div class="speech-bubble" id="speech2"></div>
                        </div>
                        <audio id="winSound" src="win.mp3"></audio>
                    `;
                document.body.appendChild(rewardDiv);

                const speech2 = document.getElementById("speech2");
                const winSound = document.getElementById("winSound");
                const rewardMessage = "Chúc mừng! Đây là quà của con";

                winSound.play().catch(err => console.log("Autoplay bị chặn:", err));
                speakText(rewardMessage);

                function typeWriterReward(text, i = 0) {
                    if (i < text.length) {
                        speech2.innerHTML = text.substring(0, i + 1);
                        let delay = 40;
                        if (text.charAt(i) === ",") delay = 200;
                        if (text.charAt(i) === "." || text.charAt(i) === "!" || text.charAt(i) === "?") delay = 400;
                        setTimeout(() => typeWriterReward(text, i + 1), delay);
                    }
                }
                typeWriterReward(rewardMessage, 0);

                startFireworks();
            } else {
                choices.style.display = "none";
                let msg = "";
                if (option === "beauty") msg = "Không thể chọn xinh đẹp vì cô đã quá xinh đẹp rồi.";
                if (option === "rich") msg = "Dạo này ít người cúng nên bụt không có tiền.";
                if (option === "hony") msg = "Chịu chịu chịu, đào đâu ra cho cô bây giờ.";

                typeWriter(msg);
                speakText(msg);
                setTimeout(() => { choices.style.display = "flex"; }, 2000);
            }
        }

        window.onload = startIntro;

        function startFireworks() {
            const canvas = document.getElementById("fireworks");
            const ctx = canvas.getContext("2d");
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const particles = [];

            function random(min, max) { return Math.random() * (max - min) + min; }

            function createFirework(x, y) {
                const count = 100;
                for (let i = 0; i < count; i++) {
                    particles.push({
                        x: x,
                        y: y,
                        vx: random(-5, 5),
                        vy: random(-5, 5),
                        alpha: 1,
                        color: `hsl(${random(0, 360)},100%,50%)`,
                        decay: random(0.01, 0.03)
                    });
                }
            }

            function animate() {
                ctx.fillStyle = "rgba(0,0,0,0.1)";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                for (let i = particles.length - 1; i >= 0; i--) {
                    const p = particles[i];
                    p.x += p.vx;
                    p.y += p.vy;
                    p.alpha -= p.decay;
                    if (p.alpha <= 0) { particles.splice(i, 1); continue; }
                    ctx.globalAlpha = p.alpha;
                    ctx.fillStyle = p.color;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, 2, 0, Math.PI * 2);
                    ctx.fill();
                }
                requestAnimationFrame(animate);
            }

            animate();

            setInterval(() => {
                const x = random(100, canvas.width - 100);
                const y = random(100, canvas.height / 2);
                createFirework(x, y);
            }, 500);
        }
    </script>
</body>
</html>
